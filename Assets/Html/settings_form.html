<!doctype html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Settings - AMT 2.0</title>
      <style>
         * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
         }

         :root {
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-card: rgba(10, 10, 10, 0.95);
            --bg-hover: #111111;
            --border: #333333;
            --border-light: #222222;
            --text-primary: #ffffff;
            --text-secondary: #888888;
            --text-muted: #444444;
            --accent: #ffffff;
            --accent-dim: rgba(255, 255, 255, 0.1);
            --success: #00ff88;
            --error: #ff4444;
         }

         body {
            font-family: "JetBrains Mono", "Consolas", monospace;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
            position: relative;
         }

         /* Animated Wave Background */
         .animated-bg {
            position: fixed;
            inset: 0;
            z-index: -1;
            overflow: hidden;
            background: var(--bg-primary);
         }

         .animated-bg::before {
            content: "";
            position: absolute;
            width: 200%;
            height: 100%;
            left: 0;
            top: 0;
            opacity: 0.04;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 800' preserveAspectRatio='none'%3E%3Cpath fill='none' stroke='white' stroke-width='1.5' d='M0,400 C200,200 400,600 600,400 C800,200 1000,600 1200,400'/%3E%3C/svg%3E")
               repeat-x;
            background-size: 50% 100%;
            animation: infiniteWave 25s linear infinite;
         }

         @keyframes infiniteWave {
            0% {
               transform: translateX(0);
            }
            100% {
               transform: translateX(-50%);
            }
         }

         /* Header */
         .header {
            height: 52px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
            background: transparent;
            border-bottom: 1px solid var(--border-light);
            cursor: move;
            -webkit-app-region: drag;
         }

         .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
         }

         .header-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
            letter-spacing: 2px;
            text-transform: uppercase;
         }

         .header-title::before {
            content: "[ ";
            color: var(--text-muted);
         }

         .header-title::after {
            content: " ]";
            color: var(--text-muted);
         }

         .header-close {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-muted);
            font-size: 14px;
            border: 1px solid var(--border-light);
            transition: all 0.2s ease;
            -webkit-app-region: no-drag;
         }

         .header-close:hover {
            background: var(--text-primary);
            color: var(--bg-primary);
            border-color: var(--text-primary);
         }

         /* Main Content */
         .main-content {
            padding: 28px;
            height: calc(100vh - 52px - 60px);
            overflow-y: auto;
         }

         .main-content::-webkit-scrollbar {
            width: 4px;
         }

         .main-content::-webkit-scrollbar-track {
            background: transparent;
         }

         .main-content::-webkit-scrollbar-thumb {
            background: var(--border);
         }

         .main-content::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
         }

         /* Section */
         .section {
            margin-bottom: 28px;
         }

         .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
         }

         .section-title {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-muted);
            letter-spacing: 3px;
            text-transform: uppercase;
         }

         .section-line {
            flex: 1;
            height: 1px;
            background: var(--border-light);
         }

         /* Settings Card */
         .settings-card {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            overflow: hidden;
         }

         /* Toggle Row */
         .toggle-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px 20px;
            transition: background 0.15s ease;
            border-bottom: 1px solid var(--border-light);
         }

         .toggle-row:last-child {
            border-bottom: none;
         }

         .toggle-row:hover {
            background: var(--bg-hover);
         }

         .toggle-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
         }

         .toggle-label {
            font-size: 12px;
            font-weight: 500;
            color: var(--text-primary);
            letter-spacing: 0.5px;
         }

         .toggle-desc {
            font-size: 10px;
            color: var(--text-muted);
            letter-spacing: 0.5px;
         }

         /* Toggle Switch - Minimal */
         .toggle-switch {
            position: relative;
            width: 40px;
            height: 20px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            cursor: pointer;
            transition: all 0.2s ease;
            flex-shrink: 0;
         }

         .toggle-switch.active {
            background: var(--text-primary);
            border-color: var(--text-primary);
         }

         .toggle-switch::after {
            content: "";
            position: absolute;
            width: 14px;
            height: 14px;
            background: var(--text-muted);
            top: 2px;
            left: 2px;
            transition: all 0.2s ease;
         }

         .toggle-switch.active::after {
            background: var(--bg-primary);
            left: 22px;
         }

         /* Action Buttons */
         .action-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
         }

         .action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 24px 16px;
            background: transparent;
            border: 1px solid var(--border-light);
            color: var(--text-secondary);
            font-family: inherit;
            cursor: pointer;
            transition: all 0.2s ease;
         }

         .action-btn:hover {
            background: var(--text-primary);
            border-color: var(--text-primary);
            color: var(--bg-primary);
         }

         .action-btn:hover .action-btn-icon svg {
            stroke: var(--bg-primary);
         }

         .action-btn:active {
            transform: scale(0.98);
         }

         .action-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            transform: none;
         }

         .action-btn-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
         }

         .action-btn-icon svg {
            width: 24px;
            height: 24px;
            stroke: var(--text-secondary);
            stroke-width: 1.5;
            fill: none;
            transition: stroke 0.2s ease;
         }

         .action-btn-text {
            font-size: 10px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
         }

         /* Cache Info */
         .cache-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-top: 16px;
            padding: 14px;
            border: 1px solid var(--border-light);
            background: transparent;
         }

         .cache-text {
            font-size: 10px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
         }

         .cache-value {
            font-weight: 600;
            color: var(--text-secondary);
         }

         /* Footer */
         .footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            padding: 0 28px;
            background: transparent;
            border-top: 1px solid var(--border-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
         }

         .version-info {
            display: flex;
            align-items: center;
            gap: 8px;
         }

         .version-badge {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-muted);
            letter-spacing: 2px;
            text-transform: uppercase;
         }

         .version-badge::before {
            content: "// ";
            color: var(--text-muted);
            opacity: 0.5;
         }

         .close-btn {
            padding: 12px 28px;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            font-family: inherit;
            font-size: 10px;
            font-weight: 600;
            letter-spacing: 2px;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.2s ease;
         }

         .close-btn:hover {
            background: var(--text-primary);
            border-color: var(--text-primary);
            color: var(--bg-primary);
         }

         /* Spinner */
         .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 1px solid var(--border);
            border-top-color: var(--text-primary);
            animation: spin 0.8s linear infinite;
         }

         @keyframes spin {
            to {
               transform: rotate(360deg);
            }
         }

         /* Toast */
         .toast {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%) translateY(20px);
            padding: 14px 24px;
            background: var(--bg-primary);
            border: 1px solid var(--border);
            color: var(--text-primary);
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 1px;
            opacity: 0;
            transition: all 0.25s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
         }

         .toast.success {
            border-color: var(--success);
         }

         .toast.success .toast-icon {
            color: var(--success);
         }

         .toast.error {
            border-color: var(--error);
         }

         .toast.error .toast-icon {
            color: var(--error);
         }

         .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
         }

         .toast-icon {
            font-size: 12px;
         }
      </style>
   </head>
   <body oncontextmenu="return false;">
      <div class="animated-bg"></div>

      <div class="header" id="dragHeader" onmousedown="startDrag()">
         <div class="header-left">
            <span class="header-title">Settings</span>
         </div>
         <div class="header-close" onclick="closeForm()">✕</div>
      </div>

      <div class="main-content">
         <!-- Startup & Behavior -->
         <div class="section">
            <div class="section-header">
               <span class="section-title">Startup & Behavior</span>
               <div class="section-line"></div>
            </div>
            <div class="settings-card">
               <div class="toggle-row">
                  <div class="toggle-info">
                     <span class="toggle-label">Run on Windows Start</span>
                     <span class="toggle-desc">Launch automatically when Windows starts</span>
                  </div>
                  <div
                     class="toggle-switch"
                     id="toggleStartup"
                     onclick="toggleSetting('startup')"
                  ></div>
               </div>
               <div class="toggle-row">
                  <div class="toggle-info">
                     <span class="toggle-label">Minimize to System Tray</span>
                     <span class="toggle-desc">Keep running in background when minimized</span>
                  </div>
                  <div class="toggle-switch" id="toggleTray" onclick="toggleSetting('tray')"></div>
               </div>
               <div class="toggle-row">
                  <div class="toggle-info">
                     <span class="toggle-label">Show Notifications</span>
                     <span class="toggle-desc">Display update and status notifications</span>
                  </div>
                  <div
                     class="toggle-switch"
                     id="toggleNotifications"
                     onclick="toggleSetting('notifications')"
                  ></div>
               </div>
            </div>
         </div>

         <!-- Actions -->
         <div class="section">
            <div class="section-header">
               <span class="section-title">Actions</span>
               <div class="section-line"></div>
            </div>
            <div class="action-grid">
               <button class="action-btn" id="btnCheckUpdates" onclick="checkUpdates()">
                  <span class="action-btn-icon">
                     <svg viewBox="0 0 24 24">
                        <path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.83 1.04 6.5 2.72" />
                        <polyline points="21 3 21 9 15 9" />
                     </svg>
                  </span>
                  <span class="action-btn-text">Check Updates</span>
               </button>
               <button class="action-btn" id="btnClearCache" onclick="clearCache()">
                  <span class="action-btn-icon">
                     <svg viewBox="0 0 24 24">
                        <polyline points="3 6 5 6 21 6" />
                        <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6" />
                        <path d="M10 11v6" />
                        <path d="M14 11v6" />
                        <path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2" />
                     </svg>
                  </span>
                  <span class="action-btn-text">Clear Cache</span>
               </button>
            </div>
            <div class="cache-info" id="cacheInfo">
               <span class="cache-text"
                  >Cache Size: <span class="cache-value" id="cacheValue">Calculating...</span></span
               >
            </div>
         </div>
      </div>

      <div class="footer">
         <div class="version-info">
            <span class="version-badge" id="versionLabel">v0.0.0</span>
         </div>
         <button class="close-btn" onclick="closeForm()">Close</button>
      </div>

      <div class="toast" id="toast">
         <span class="toast-icon">✓</span>
         <span class="toast-text"></span>
      </div>

      <script>
         // State
         let settings = {
            startup: false,
            tray: false,
            notifications: true,
         };

         // Initialize
         function initSettings(data) {
            settings = { ...settings, ...data };
            updateToggles();
         }

         function setVersion(version) {
            document.getElementById("versionLabel").textContent = "v" + version;
         }

         function updateToggles() {
            document.getElementById("toggleStartup").classList.toggle("active", settings.startup);
            document.getElementById("toggleTray").classList.toggle("active", settings.tray);
            document
               .getElementById("toggleNotifications")
               .classList.toggle("active", settings.notifications);
         }

         // Actions
         function toggleSetting(key) {
            settings[key] = !settings[key];
            updateToggles();
            sendMessage({ type: "settingChanged", key: key, value: settings[key] });
         }

         function checkUpdates() {
            const btn = document.getElementById("btnCheckUpdates");
            btn.innerHTML = '<span class="spinner"></span>';
            btn.disabled = true;
            sendMessage({ type: "checkUpdates" });
         }

         function clearCache() {
            const btn = document.getElementById("btnClearCache");
            btn.innerHTML = '<span class="spinner"></span>';
            btn.disabled = true;
            sendMessage({ type: "clearCache" });
         }

         function resetButton(buttonId, iconHtml, text) {
            const btn = document.getElementById(buttonId);
            if (btn) {
               btn.innerHTML = `<span class="action-btn-icon"><svg viewBox="0 0 24 24"><path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.83 1.04 6.5 2.72"/><polyline points="21 3 21 9 15 9"/></svg></span><span class="action-btn-text">${text}</span>`;
               btn.disabled = false;
            }
         }

         function resetClearCacheButton() {
            const btn = document.getElementById("btnClearCache");
            if (btn) {
               btn.innerHTML =
                  '<span class="action-btn-icon"><svg viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6"/><path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/><path d="M10 11v6"/><path d="M14 11v6"/><path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/></svg></span><span class="action-btn-text">Clear Cache</span>';
               btn.disabled = false;
            }
         }

         function setCacheSize(size) {
            const el = document.getElementById("cacheValue");
            if (el) el.textContent = size;
         }

         function revertSetting(key, value) {
            settings[key] = value;
            updateToggles();
         }

         function showToast(message, type = "success") {
            const toast = document.getElementById("toast");
            const icon = type === "success" ? "✓" : "✕";
            toast.querySelector(".toast-icon").textContent = icon;
            toast.querySelector(".toast-text").textContent = message;
            toast.className = "toast " + type + " show";
            setTimeout(() => {
               toast.classList.remove("show");
            }, 3000);
         }

         function closeForm() {
            sendMessage({ type: "close" });
         }

         function startDrag() {
            sendMessage({ type: "startDrag" });
         }

         function sendMessage(data) {
            if (window.chrome && window.chrome.webview) {
               window.chrome.webview.postMessage(data);
            }
         }
      </script>
   </body>
</html>
